<!DOCTYPE html>
<html lang="pt-BR" class="scroll-suave">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <meta
      name="description"
      content="Painel administrativo do sistema HotelBooking para gerenciamento de hotéis."
    />
    <meta name="keywords" content="admin, hotel, gerenciamento, microserviços, AWS" />
    <meta name="author" content="Danilo Silva" />

    <title>Admin - HotelBooking Sistema de Reservas</title>

    <!-- Preconnect para otimização de performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="preconnect" href="https://cdnjs.cloudflare.com" />

    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css"
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
      integrity="sha512-t4GWSVZO1eC8BM339Xd7Uphw5s17a86tIZIj8qRxhnKub6WoyhnrxeCIMeAqBPgdZGlCcG2PrZjMc+Wr78+5Xg=="
    />

    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
      integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
    />

    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <!-- Estilos customizados -->
    <link rel="stylesheet" href="assets/css/styles.css" />
  </head>

  <body>
    <!-- Cabeçalho da Página -->
    <header class="secao-principal py-4">
      <div class="container">
        <div class="row align-items-center">
          <div class="col-md-8">
            <div class="secao-principal__conteudo">
              <h1 class="secao-principal__titulo h2 mb-0">
                <i class="fas fa-shield-alt me-3" aria-hidden="true"></i>
                Painel Administrativo
              </h1>
              <p class="secao-principal__subtitulo mb-0">
                Gerenciamento completo do sistema HotelBooking
              </p>
            </div>
          </div>
          <div class="col-md-4 text-end">
            <!-- Botões de Autenticação -->
            <nav
              class="botoes-autenticacao position-relative"
              role="navigation"
              aria-label="Autenticação"
            >
              <button
                id="btnEntrar"
                class="botao-customizado botao--primario me-2"
                type="button"
                aria-label="Fazer login no sistema"
              >
                <i class="fas fa-sign-in-alt me-2" aria-hidden="true"></i>
                Entrar
              </button>
              <button
                id="btnSair"
                class="botao-customizado botao--contorno"
                type="button"
                style="display: none"
                aria-label="Sair do sistema"
              >
                <i class="fas fa-sign-out-alt me-2" aria-hidden="true"></i>
                Sair
              </button>
            </nav>
          </div>
        </div>
      </div>
    </header>

    <!-- Conteúdo Principal -->
    <main class="container my-5">
      <!-- Seção de Ações -->
      <section class="mb-5">
        <div class="row">
          <div class="col-12">
            <div class="cartao-funcionalidade">
              <h2 class="cartao-funcionalidade__titulo">
                <i class="fas fa-plus-circle me-2" aria-hidden="true"></i>
                Ações Rápidas
              </h2>
              <div class="mt-3">
                <a
                  id="btnAdicionarHotel"
                  href="addHotel.html"
                  class="botao-customizado botao--primario"
                  role="button"
                  aria-label="Adicionar novo hotel ao sistema"
                >
                  <i class="fas fa-hotel me-2" aria-hidden="true"></i>
                  Adicionar Hotel
                </a>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Seção de Lista de Hotéis -->
      <section>
        <div class="row">
          <div class="col-12">
            <div class="cartao-funcionalidade">
              <h2 class="cartao-funcionalidade__titulo">
                <i class="fas fa-list me-2" aria-hidden="true"></i>
                Lista de Hotéis
              </h2>

              <!-- Loading State -->
              <div id="carregandoHoteis" class="text-center py-4">
                <i class="fas fa-spinner animacao-girar me-2" aria-hidden="true"></i>
                Carregando hotéis...
              </div>

              <!-- Tabela de Hotéis -->
              <div id="containerTabelaHoteis" style="display: none">
                <div class="table-responsive">
                  <table id="tabelaListaHoteis" class="table table-striped table-hover">
                    <thead class="table-dark">
                      <tr>
                        <th scope="col">
                          <i class="fas fa-signature me-1" aria-hidden="true"></i>
                          Nome
                        </th>
                        <th scope="col">
                          <i class="fas fa-map-marker-alt me-1" aria-hidden="true"></i>
                          Cidade
                        </th>
                        <th scope="col">
                          <i class="fas fa-dollar-sign me-1" aria-hidden="true"></i>
                          Preço
                        </th>
                        <th scope="col">
                          <i class="fas fa-star me-1" aria-hidden="true"></i>
                          Avaliação
                        </th>
                        <th scope="col">
                          <i class="fas fa-image me-1" aria-hidden="true"></i>
                          Imagem
                        </th>
                      </tr>
                    </thead>
                    <tbody>
                      <!-- Dados serão inseridos via JavaScript -->
                    </tbody>
                  </table>
                </div>
              </div>

              <!-- Estado Vazio -->
              <div id="estadoVazio" class="text-center py-5" style="display: none">
                <i
                  class="fas fa-hotel"
                  style="font-size: 4rem; color: var(--texto-claro)"
                  aria-hidden="true"
                ></i>
                <h3 class="mt-3 text-muted">Nenhum hotel encontrado</h3>
                <p class="text-muted">Adicione o primeiro hotel ao sistema</p>
                <a href="addHotel.html" class="botao-customizado botao--primario">
                  <i class="fas fa-plus me-2" aria-hidden="true"></i>
                  Adicionar Primeiro Hotel
                </a>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>

    <!-- Scripts -->
    <!-- jQuery -->
    <script
      src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"
      integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>

    <!-- Bootstrap JavaScript -->
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/js/bootstrap.bundle.min.js"
      integrity="sha512-VK2zcvntEufaimc+efOYi622VN5ZacdnufnmX7zIhCPmjhKnOi9ZDMtg1/ug5l183f19gG1/cBstPO4D8N/Img=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>

    <!-- AWS Cognito SDK (Local) -->
    <script src="assets/js/amazon-cognito-auth.js"></script>

    <!-- Configuração do Cognito -->
    <script src="assets/js/cognito.js"></script>

    <!-- Aplicação principal -->
    <script src="assets/js/app.js"></script>

    <!-- JavaScript específico da página Admin -->
    <script>
      /**
       * Configurações específicas da página Admin
       */
      const AdminPage = {
        configuracoes: {
          urlBaseS3: 'https://hotel-admin-bucket.s3.ap-southeast-2.amazonaws.com',
          urlAPI: '<api url here>', // Substitua pela URL real da API
        },

        /**
         * Inicializa a página Admin
         */
        inicializar: function () {
          console.log('Página Admin inicializada');

          // Aguarda a inicialização do sistema principal
          setTimeout(() => {
            if (tokenUsuarioAtual && tokenUsuarioAtual.idToken) {
              this.popularListaHoteis(tokenUsuarioAtual.idToken);
            } else {
              console.warn('Token não disponível para carregar hotéis');
              this.mostrarEstadoVazio();
            }
          }, 1000);
        },

        /**
         * Popula a lista de hotéis (adaptado do curso)
         */
        popularListaHoteis: function (idToken) {
          const self = this;

          $.ajax({
            url: self.configuracoes.urlAPI,
            type: 'GET',
            data: { token: idToken },
            dataType: 'json',
            beforeSend: function () {
              $('#carregandoHoteis').show();
              $('#containerTabelaHoteis').hide();
              $('#estadoVazio').hide();
            },
            success: function (response) {
              console.log('Hotéis carregados:', response);

              if (response.Hotels && response.Hotels.length > 0) {
                self.renderizarTabelaHoteis(response.Hotels);
                $('#carregandoHoteis').hide();
                $('#containerTabelaHoteis').show();
              } else {
                self.mostrarEstadoVazio();
              }
            },
            error: function (xhr, status, error) {
              console.error('Erro ao carregar hotéis:', error);
              $('#carregandoHoteis').hide();

              // Mostra dados de exemplo para desenvolvimento
              self.mostrarDadosExemplo();
            },
          });
        },

        /**
         * Renderiza a tabela de hotéis
         */
        renderizarTabelaHoteis: function (hoteis) {
          const tbody = $('#tabelaListaHoteis tbody');
          tbody.empty();

          $.each(hoteis, (index, hotel) => {
            const linha = $('<tr>');

            linha.append($('<td>').text(hotel.Name || 'N/A'));
            linha.append($('<td>').text(hotel.CityName || 'N/A'));
            linha.append($('<td>').text(hotel.Price ? `R$ ${hotel.Price}` : 'N/A'));
            linha.append($('<td>').text(hotel.Rating ? `${hotel.Rating}⭐` : 'N/A'));

            // Imagem
            const imagemCol = $('<td>');
            if (hotel.FileName) {
              const imagemTag = $('<img>')
                .attr('src', `${this.configuracoes.urlBaseS3}/${hotel.FileName}`)
                .attr('alt', `Foto do hotel ${hotel.Name}`)
                .addClass('img-thumbnail')
                .css({
                  width: '150px',
                  height: '100px',
                  'object-fit': 'cover',
                });
              imagemCol.append(imagemTag);
            } else {
              imagemCol.html('<span class="text-muted">Sem imagem</span>');
            }
            linha.append(imagemCol);

            tbody.append(linha);
          });
        },

        /**
         * Mostra estado vazio
         */
        mostrarEstadoVazio: function () {
          $('#carregandoHoteis').hide();
          $('#containerTabelaHoteis').hide();
          $('#estadoVazio').show();
        },

        /**
         * Mostra dados de exemplo para desenvolvimento
         */
        mostrarDadosExemplo: function () {
          const dadosExemplo = [
            {
              Name: 'Hotel Exemplo 1',
              CityName: 'São Paulo',
              Price: '250.00',
              Rating: '4.5',
              FileName: null,
            },
            {
              Name: 'Hotel Exemplo 2',
              CityName: 'Rio de Janeiro',
              Price: '180.00',
              Rating: '4.0',
              FileName: null,
            },
          ];

          this.renderizarTabelaHoteis(dadosExemplo);
          $('#carregandoHoteis').hide();
          $('#containerTabelaHoteis').show();

          console.log('Mostrando dados de exemplo (API não disponível)');
        },
      };

      // Inicializa quando o DOM estiver pronto
      $(document).ready(() => {
        // Aguarda a inicialização do sistema principal
        setTimeout(() => {
          AdminPage.inicializar();
        }, 500);
      });
    </script>
  </body>
</html>
